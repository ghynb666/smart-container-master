---
name: "FunctionalDesignDocGenerator"
description: "功能设计文档生成器，在Plan模式下根据自然语言需求生成标准化软件功能设计文档，覆盖全流程，作为开发、测试、产品验收依据。"
---

# FunctionalDesignDocGenerator

## 技能描述

在Plan模式下，根据对话框中描述的功能需求，自动生成标准化、高质量的软件功能设计文档，覆盖从需求分析到测试验收的全流程，作为开发、测试、产品验收的唯一依据。

## 核心能力

- 支持根据自然语言描述的功能需求，直接生成完整设计文档
- 提供标准化文档模板，包含10个核心章节，确保无遗漏关键设计要素
- 自动识别并填充数据模型、接口、权限、业务流程等技术细节
- 生成可执行的开发任务清单，明确任务优先级与依赖关系
- 在Plan视图中清晰展示文档结构与编写进度，支持实时协作编辑

## 触发关键词

#功能设计 #FD #设计文档 #系统设计 #Plan模式设计

## 文档结构

1. **文档概述**（版本、作者、日期、变更记录）
2. **需求分析**（问题背景、用户痛点、核心需求）
3. **功能概述**（功能列表、优先级、用户场景）
4. **系统架构**（整体架构图、模块划分、技术选型）
5. **数据模型**（ER图、数据表设计、字段说明）
6. **接口设计**（API列表、参数、返回值、错误码）
7. **业务流程**（流程图、状态机、关键路径）
8. **界面设计**（页面结构、交互逻辑、原型链接）
9. **非功能需求**（性能、安全、兼容性、可扩展性）
10. **测试用例**（功能测试、边界测试、异常测试）

## 使用方法

在Plan模式对话框中输入触发关键词+功能需求描述，如：

```
#功能设计 我需要实现一个用户注册登录功能，包含手机号验证、密码加密存储、第三方登录（微信/QQ）和忘记密码功能
```

AI自动在Plan视图中生成完整功能设计文档。

## Plan模式适配

- 自动在Plan视图中创建文档大纲
- 分章节展示编写进度
- 支持点击章节直接编辑内容
- 生成.md文件

## 生成文档示例

```markdown
# 功能设计文档

## 1. 文档概述

### 1.1 基本信息
- **文档名称**：用户注册登录功能设计文档
- **版本**：v1.0
- **作者**：AI生成
- **日期**：2026-01-21

### 1.2 变更记录
| 版本 | 变更内容 | 作者 | 日期 |
|------|----------|------|------|
| v1.0 | 初始版本 | AI生成 | 2026-01-21 |

## 2. 需求分析

### 2.1 问题背景
随着业务发展，需要提供用户注册登录功能，支持多种登录方式，保障用户信息安全。

### 2.2 用户痛点
- 传统登录方式单一，不够便捷
- 密码安全问题担忧
- 忘记密码找回流程复杂

### 2.3 核心需求
- 手机号验证注册
- 密码加密存储
- 第三方登录（微信/QQ）
- 忘记密码功能

## 3. 功能概述

### 3.1 功能列表
| 功能模块 | 优先级 | 描述 |
|----------|--------|------|
| 手机号注册 | 高 | 通过手机号验证码完成注册 |
| 密码登录 | 高 | 使用手机号和密码登录 |
| 微信登录 | 中 | 支持微信第三方登录 |
| QQ登录 | 中 | 支持QQ第三方登录 |
| 忘记密码 | 中 | 密码找回功能 |

### 3.2 用户场景
- 新用户通过手机号注册
- 老用户使用密码登录
- 用户选择第三方登录方式快捷登录
- 用户忘记密码时通过验证码找回

## 4. 系统架构

### 4.1 整体架构图
```
用户层 -> 应用层 -> 服务层 -> 数据层
```

### 4.2 模块划分
- 用户认证模块
- 验证码服务模块
- 第三方登录集成模块
- 密码管理模块

### 4.3 技术选型
- 后端框架：Spring Boot
- 数据库：MySQL
- 缓存：Redis
- 验证码：阿里云短信服务
- 第三方登录：OAuth2.0

## 5. 数据模型

### 5.1 ER图
```
用户表 <-> 第三方登录关联表
     <-> 验证码记录表
```

### 5.2 数据表设计

#### 5.2.1 用户表（user）
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | BIGINT | PRIMARY KEY | 用户ID |
| phone | VARCHAR(11) | UNIQUE NOT NULL | 手机号 |
| password | VARCHAR(128) | NOT NULL | 加密密码 |
| nickname | VARCHAR(50) | | 昵称 |
| avatar | VARCHAR(255) | | 头像 |
| status | TINYINT | DEFAULT 1 | 状态（1：正常，0：禁用） |
| create_time | DATETIME | NOT NULL | 创建时间 |
| update_time | DATETIME | NOT NULL | 更新时间 |

#### 5.2.2 第三方登录关联表（user_third_party）
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | BIGINT | PRIMARY KEY | ID |
| user_id | BIGINT | FOREIGN KEY | 用户ID |
| third_party_type | TINYINT | NOT NULL | 第三方类型（1：微信，2：QQ） |
| third_party_id | VARCHAR(100) | NOT NULL | 第三方用户ID |
| create_time | DATETIME | NOT NULL | 创建时间 |

#### 5.2.3 验证码记录表（verify_code）
| 字段名 | 数据类型 | 约束 | 描述 |
|--------|----------|------|------|
| id | BIGINT | PRIMARY KEY | ID |
| phone | VARCHAR(11) | NOT NULL | 手机号 |
| code | VARCHAR(6) | NOT NULL | 验证码 |
| type | TINYINT | NOT NULL | 类型（1：注册，2：登录，3：忘记密码） |
| expire_time | DATETIME | NOT NULL | 过期时间 |
| status | TINYINT | DEFAULT 0 | 状态（0：未使用，1：已使用） |
| create_time | DATETIME | NOT NULL | 创建时间 |

## 6. 接口设计

### 6.1 API列表

| 接口路径 | 方法 | 功能描述 |
|----------|------|----------|
| /api/auth/send-code | POST | 发送验证码 |
| /api/auth/register | POST | 用户注册 |
| /api/auth/login | POST | 密码登录 |
| /api/auth/third-party/login | POST | 第三方登录 |
| /api/auth/reset-password | POST | 重置密码 |

### 6.2 接口详情

#### 6.2.1 发送验证码
- **请求URL**：/api/auth/send-code
- **请求方法**：POST
- **请求参数**：
  | 参数名 | 类型 | 必传 | 描述 |
  |--------|------|------|------|
  | phone | String | 是 | 手机号 |
  | type | Integer | 是 | 验证码类型（1：注册，2：登录，3：忘记密码） |

- **返回结果**：
  ```json
  {
    "code": 200,
    "message": "验证码发送成功",
    "data": null
  }
  ```

#### 6.2.2 用户注册
- **请求URL**：/api/auth/register
- **请求方法**：POST
- **请求参数**：
  | 参数名 | 类型 | 必传 | 描述 |
  |--------|------|------|------|
  | phone | String | 是 | 手机号 |
  | code | String | 是 | 验证码 |
  | password | String | 是 | 密码 |
  | nickname | String | 否 | 昵称 |

- **返回结果**：
  ```json
  {
    "code": 200,
    "message": "注册成功",
    "data": {
      "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    }
  }
  ```

## 7. 业务流程

### 7.1 手机号注册流程
1. 用户输入手机号，点击获取验证码
2. 系统验证手机号格式，生成验证码
3. 调用短信服务发送验证码
4. 用户输入验证码和密码，点击注册
5. 系统验证验证码有效性
6. 加密密码，创建用户记录
7. 返回登录token

### 7.2 第三方登录流程
1. 用户选择第三方登录方式（微信/QQ）
2. 跳转至第三方授权页面
3. 用户授权后，第三方返回授权码
4. 系统使用授权码获取第三方用户信息
5. 检查是否已绑定本地账号
6. 若未绑定，创建新用户并绑定
7. 返回登录token

## 8. 界面设计

### 8.1 页面结构
- 注册页面：手机号输入、验证码输入、密码输入、注册按钮
- 登录页面：手机号/密码登录、第三方登录入口（微信/QQ）、忘记密码链接
- 忘记密码页面：手机号输入、验证码输入、新密码输入、确认按钮

### 8.2 交互逻辑
- 验证码倒计时功能
- 密码强度校验
- 表单实时验证

## 9. 非功能需求

### 9.1 性能
- 验证码发送响应时间 < 500ms
- 登录响应时间 < 300ms

### 9.2 安全
- 密码使用BCrypt加密存储
- 验证码有效期5分钟
- 同一手机号1分钟内最多发送1次验证码
- 登录失败5次后锁定账号1小时

### 9.3 兼容性
- 支持iOS 13+、Android 8+移动设备
- 支持Chrome、Firefox、Safari等主流浏览器

### 9.4 可扩展性
- 设计支持后续扩展更多第三方登录方式

## 10. 测试用例

### 10.1 功能测试
| 测试编号 | 测试场景 | 预期结果 |
|----------|----------|----------|
| TC001 | 正确手机号获取验证码 | 验证码发送成功 |
| TC002 | 正确验证码注册 | 注册成功，返回token |
| TC003 | 正确账号密码登录 | 登录成功，返回token |
| TC004 | 微信授权登录 | 登录成功，返回token |
| TC005 | QQ授权登录 | 登录成功，返回token |
| TC006 | 忘记密码流程 | 密码重置成功 |

### 10.2 边界测试
| 测试编号 | 测试场景 | 预期结果 |
|----------|----------|----------|
| TC007 | 手机号格式错误 | 返回参数错误 |
| TC008 | 验证码过期 | 返回验证码无效 |
| TC009 | 密码长度不足 | 返回参数错误 |

### 10.3 异常测试
| 测试编号 | 测试场景 | 预期结果 |
|----------|----------|----------|
| TC010 | 同一手机号1分钟内重复获取验证码 | 返回操作频繁 |
| TC011 | 验证码输入错误 | 返回验证码错误 |
| TC012 | 密码错误5次 | 账号锁定1小时 |
```
